#!/usr/bin/env python

from lxml import html
import os
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "fuzziverse.settings")
from fuzziverse import models
t = html.parse("http://lcamtuf.coredump.cx/afl/")
for entry in t.xpath('//td'):
        app = models.Application()
        name = entry.text.rstrip()
        print("Adding: %s" % name)
        app.name = name
        app.save()
        for link in entry.xpath('.//a'):
                report = models.Report()
                report.app = app
                report.title = "(autogenerated from Lcamtuf's page)"
                report.url = link.get('href')
                report.save()
